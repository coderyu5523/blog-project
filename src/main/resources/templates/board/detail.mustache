{{>layout/header}}
{{#DetailDTO}}
    <div class="container p-5">
        <!-- ê²Œì‹œê¸€ë‚´ìš© -->
        <div>
            <div class="d-flex justify-content-between">
                <h2><b>{{title}}</b></h2>
                <h6>{{createdAt}}</h6>
            </div>
            <hr>
            <div class="d-flex justify-content-between">
                <span><b>ì‘ì„±ì</b> : {{user.username}}</span>
                <span><b>ì¹´í…Œê³ ë¦¬</b> : {{category}}</span>
            </div>
            <hr/>
            <div class="row justify-content-center" style="align-items: center">
                <div class="col-md-6">
                    <div class="d-flex justify-content-center mb-3">
                        <div class="position-relative">
                            <div class="box-container">
                                <div class="d-flex justify-content-center align-items-center" id="boardImg">
                                    {{#boardImg}}
                                        <img style="max-width: 100%; max-height: 100%; object-fit: contain;"
                                             src="/upload/{{boardImg}}" alt="">
                                    {{/boardImg}}
                                    {{^boardImg}}
                                        <div style="height: 150px"></div>
                                    {{/boardImg}}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="m-4 p-2">
                    {{content}}
                </div>
            </div>

            {{#isBoardOwner}}
                <!-- ìˆ˜ì •ì‚­ì œë²„íŠ¼ -->
                <div class="d-flex justify-content-end">
                    <a href="/boards/{{id}}/update-form" class="btn btn-warning me-1">ìˆ˜ì •</a>
                    <form action="/boards/{{id}}/delete" method="post">
                        <button class="btn btn-danger">ì‚­ì œ</button>
                    </form>
                </div>
            {{/isBoardOwner}}
            <!-- ëŒ“ê¸€ -->
            <div class="card mt-3">
                <!-- ëŒ“ê¸€ë“±ë¡ -->
                <div class="card-body">
                    <form action="/replies/save" method="post">
                        <textarea class="form-control" rows="2" name="comment"></textarea>
                        <div class="d-flex justify-content-end">
                            <input type="hidden" name="boardId" value="{{id}}">
                            <button type="submit" class="btn btn-outline-primary mt-1">ëŒ“ê¸€ë“±ë¡</button>
                        </div>
                    </form>
                </div>

                <!-- ëŒ“ê¸€ëª©ë¡ -->
                <div class="card-footer">
                    <b>ëŒ“ê¸€ë¦¬ìŠ¤íŠ¸</b>
                </div>
                {{#replies}}
                <div class="list-group">
                    <!-- ëŒ“ê¸€ì•„ì´í…œ -->
                    <div class="list-group-item d-flex justify-content-between align-items-center"
                         style="height: 50px;" data-id="{{id}}">
                        <div class="d-flex">
                            <div class="px-1 me-1 bg-primary text-white rounded">{{username}}</div>
                            <div>{{comment}}</div>
                        </div>
                        <div class="inline-elements">
                            {{#isReplyOwner}}
                                <form action="/replies/{{id}}/delete" method="post">
                                    <button class="btn">ğŸ—‘</button>
                                </form>
                            {{/isReplyOwner}}
                            {{#sessionUser}}
                                <a class="text-body add-reply" href="#">ëŒ“ê¸€ë‹¬ê¸°</a>
                            {{/sessionUser}}
                        </div>
                    </div>
                    <div class="comment-form">
                        <!-- ëŒ“ê¸€ ì…ë ¥ í¼ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë  ì˜ì—­ -->
                    </div>
                    {{#reply2List}}
                    <div class="list-group">
                        <!-- ëŒ€ëŒ“ê¸€  -->
                        <div class="list-group-item d-flex justify-content-between align-items-center"
                             style="height: 50px;" data-id="{{id}}">
                            <div class="d-flex">
                                <div style="margin-right: 5px;">â””</div>
                                <div class="px-1 me-1 bg-primary text-white rounded">{{username}}</div>
                                <div>{{comment}}</div>
                            </div>
                            {{#isReply2Owner}}
                                <div class="inline-elements">
                                    <form action="/replies2/{{reply2Id}}/delete" method="post">
                                        <button class="btn">ğŸ—‘</button>
                                    </form>
                                </div>
                            {{/isReply2Owner}}
                        </div>
                    {{/reply2List}}
                {{/replies}}
            </div>
            </div>
            </div>
        </div>
    </div>
    </div>
    </div>
    </div>
{{/DetailDTO}}

{{>layout/footer}}

<script>
    $(document).ready(function () {
        $('.add-reply').click(function (event) {
            event.preventDefault();
            const parent = $(this).closest('.list-group-item').next('.comment-form');

            if (parent.is(':hidden')) {
                parent.html(`
                        <form action="/replies2/save" method="post" class="w-100 mt-2">
                            <textarea class="form-control" rows="2" name="comment"></textarea>
                            <div class="d-flex justify-content-end mt-1">
                                <input type="hidden" name="replyId" value="${$(this).closest('.list-group-item').data('id')}">
                                <button type="submit" class="btn btn-outline-primary">ëŒ“ê¸€ë“±ë¡</button>
                            </div>
                        </form>`);
                parent.show();
            } else {
                parent.hide();
            }
        });
    });
</script>
